const crypto=require("crypto"),{readFile:readFile}=require("fs").promises,{writeFile:writeFile}=require("fs");module.exports={encrypt:async function(e,r,t){const i=await readFile(e,{encoding:null}),n=await readFile(t,{encoding:"utf8"}),a=Buffer.from(n,"base64"),c=crypto.randomBytes(16);let o;try{o=crypto.createCipheriv("aes-256-cbc",a,c)}catch(e){return!0}let l=o.update(i);l=Buffer.concat([l,o.final()]),writeFile(r,l.toString("base64")+c.toString("base64"),function(e){return!!e})}};