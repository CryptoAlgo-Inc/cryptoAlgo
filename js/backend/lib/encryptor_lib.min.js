const crypto=require("crypto"),{readFile:readFile}=require("fs").promises,{writeFile:writeFile}=require("fs");module.exports={encrypt:async function(r,e,t){const i=await readFile(r,{encoding:"utf8"}),n=await readFile(e,{encoding:"utf8"}),o=Buffer.from(n,"utf8");try{const r=crypto.publicEncrypt(i,o);writeFile(t,r.toString("base64"),r=>(r&&console.error(r),!!r))}catch(r){return console.error("Error thrown while encrypting AES keyfile:\n\n",r),1}},decrypt:async function(r,e,t,i){const n=await readFile(r,{encoding:"utf8"}),o=await readFile(t,{encoding:"utf8"}),c=Buffer.from(o,"base64");try{const r=crypto.privateDecrypt({key:n,passphrase:e},c);writeFile(i,r.toString("utf8"),r=>(r&&console.error(r),!!r))}catch(r){return console.error("Error thrown while decrypting AES keyfile:\n\n",r),1}}};