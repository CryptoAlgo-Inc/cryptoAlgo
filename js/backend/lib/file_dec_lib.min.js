const crypto=require("crypto"),{readFile:readFile}=require("fs").promises,{writeFile:writeFile}=require("fs");module.exports={decrypt:async function(e,r,t){const i=await readFile(e,{encoding:"utf8"}),c=i.toString().slice(0,-24),o=await readFile(t,{encoding:"utf8"}),a=Buffer.from(o,"base64"),f=i.toString().slice(-24),n=Buffer.from(f,"base64");try{const e=crypto.createDecipheriv("aes-256-cbc",a,n);let t=e.update(Buffer.from(c,"base64"));return t=Buffer.concat([t,e.final()]),writeFile(r,t,e=>(e&&console.error(e),!!e)),0}catch(e){return e}}};