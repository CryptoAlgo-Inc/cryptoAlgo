const crypto=require("crypto"),{readFile:readFile}=require("fs").promises,{writeFile:writeFile}=require("fs");module.exports={decrypt:async function(e,r,t){const i=await readFile(e,{encoding:"utf8"}),c=i.toString().slice(0,-24),o=await readFile(t,{encoding:"utf8"}),n=Buffer.from(o,"base64"),a=i.toString().slice(-24),f=Buffer.from(a,"base64");try{const e=crypto.createDecipheriv("aes-256-cbc",n,f);let t=e.update(Buffer.from(c,"base64"));return t=Buffer.concat([t,e.final()]),writeFile(r,t,function(e){return e&&console.error(e),!!e}),0}catch(e){return e}}};