const{writeFile:writeFile}=require("fs"),{generateKeyPair:generateKeyPair}=require("crypto");module.exports={gen:function(e,r,n,i){generateKeyPair("rsa",{modulusLength:e,publicKeyEncoding:{type:"pkcs1",format:"pem"},privateKeyEncoding:{type:"pkcs1",format:"pem",cipher:"aes-256-cbc",passphrase:r}},(e,r,o)=>{if(e)return console.error(e),3;const t=/.pem$/gm;writeFile(n.replace(t,"-pri.pem"),o,function(e){e&&(console.error(e),i(2)),writeFile(n.replace(t,"-pub.pem"),r,function(e){e?(console.error(e),i(1)):(console.debug("<RSA_Keygen_lib> Done generating one keyfile"),i(null))})})})}};