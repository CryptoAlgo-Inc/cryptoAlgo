const crypto=require("crypto"),{readFile:readFile}=require("fs").promises;module.exports={encrypt:async function(e,r){const t=await readFile(r,{encoding:"utf8"}),c=Buffer.from(t,"base64"),i=crypto.randomBytes(16);let n;try{n=crypto.createCipheriv("aes-256-cbc",c,i)}catch(e){return{cipher:null,iv:null,err:e}}let a=n.update(e);return{cipher:(a=Buffer.concat([a,n.final()])).toString("base64"),iv:i.toString("base64"),err:null}}};