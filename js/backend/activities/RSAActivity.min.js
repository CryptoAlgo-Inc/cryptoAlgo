function $(e){return document.getElementById(e)}function q(e){return document.querySelector(e)}function showSnackbar(e,t=5e3){const l=q(".mdc-snackbar").MDCSnackbar;l.labelText=e,l.timeoutMs=t,l.open()}async function onStart(){let e=null,t=null,l=null;const n=()=>{if($("selected-keyfile").textContent=null!=e?"Selected keyfile: "+e:"No selected keyfile",$("AESLoc").textContent=null!=t?"Selected AES keyfile: "+t:"No AES keyfile selected",$("outLoc").textContent=null!=l?"Selected output location: "+l:"No output location selected",e&&t&&l){const e=$("encButton"),l=$("decButton");t.match(/\.aKey$/gm)?(e.disabled=!1,l.disabled=!0):(e.disabled=!0,l.disabled=!1)}};$("selKeyfile").onclick=(()=>{window.fileOps.fileOpen("Select RSA Keyfile","Select Keyfile",["openFile"],[{name:"RSA Keypair",extensions:["pem"]}]).then(t=>{t.canceled?showSnackbar("RSA keypair file picker canceled"):(e=t.filePaths[0],n())})}),$("selAESKeyfile").onclick=(()=>{window.fileOps.fileOpen("Select encrypted/decrypted AES Keyfile","Select Keyfile",["openFile"],[{name:"AES Keyfile",extensions:["aKey"]},{name:"Encrypted AES Keyfile",extensions:["cryptKey"]}]).then(e=>{e.canceled?showSnackbar("RSA keypair file picker canceled"):(t=e.filePaths[0],n())})}),$("selOutLoc").onclick=(()=>{if(null==t)return void showSnackbar("Select the input AES keyfile first.");let e;e=t.match(/\.aKey$/gm)?{name:"Encrypted AES Keyfile",extensions:["cryptKey"]}:{name:"Decrypted AES Keyfile",extensions:["aKey"]},window.fileOps.filePick("Select location to save output file","Output file name: ",[],[e],t.replace(/(\..*)$/gm,"")).then(e=>{e.canceled?showSnackbar("Output file picker canceled"):(l=e.filePath,n())})}),$("encButton").onclick=(()=>{window.rsaCrypto.encrypt(e,t,l).then(e=>{showSnackbar(e?"Failed to encrypt AES keyfile. Check if public key is selected and valid.":"Encrypted AES keyfile saved at: "+l)}).catch(e=>{showSnackbar("Failed to encrypt AES keyfile. Check if files are readable.")})}),$("decButton").onclick=(()=>{window.rsaCrypto.decrypt(e,$("priPWD").MDCTextField.value,t,l).then(e=>{e?showSnackbar("Failed to decrypt AES keyfile. Check if private key is selected, valid and password is correct.",6e3):showSnackbar("Decrypted AES keyfile saved at: "+l)}).catch(e=>{showSnackbar("Failed to decrypt AES keyfile. Check if files are readable.")})})}function onStop(){}