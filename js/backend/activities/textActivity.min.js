function $(e){return document.getElementById(e)}function q(e){return document.querySelector(e)}function hideAfterDelay(e,t){null!=window.prevTimeOut&&(clearTimeout(prevTimeOut),window.prevTimeOut=null),window.prevTimeOut=setTimeout(()=>{e.classList.add("hidden"),window.prevTimeOut=null},t)}function showSnackbar(e,t=5e3){const n=q(".mdc-snackbar").MDCSnackbar;n.labelText=e,n.timeoutMs=t,n.open()}async function onStart(){let e=null,t=null;q(".mdc-tab-bar").MDCTabBar.listen("MDCTabBar:activated",function(e){const t=$("encryptContent"),n=$("decryptContent");switch(e.detail.index){case 0:t.classList.remove("hidden"),t.classList.remove("contentSwitcher-outLeft"),n.classList.add("contentSwitcher-outRight"),hideAfterDelay(n,250);break;case 1:n.classList.remove("hidden"),t.classList.add("contentSwitcher-outLeft"),n.classList.remove("contentSwitcher-outRight"),hideAfterDelay(t,250)}}),$("enc-open-keyfile").onclick=(async()=>{window.fileOps.fileOpen("Select AES Keyfile","Select Keyfile",["openFile"],[{name:"AES Keyfiles",extensions:["aKey"]}]).then(t=>{t.canceled||(e=t.filePaths[0],$("enc-selected-key").textContent=`Currently selected keyfile: '${e.replace(/^.*\//gm,"")}'`)})}),$("dec-open-keyfile").onclick=(async()=>{window.fileOps.fileOpen("Select AES Keyfile","Select Keyfile",["openFile"],[{name:"AES Keyfiles",extensions:["aKey"]}]).then(e=>{e.canceled||(t=e.filePaths[0],$("dec-selected-key").textContent=`Currently selected keyfile: '${t.replace(/^.*\//gm,"")}'`)})});const n=(t,n=!1)=>{0!==t.length?null!=e?window.aesCrypto.encrypt(t,e).then(e=>{const t=$("encrypted-output");if(null!=e.err)return showSnackbar("Failed to encrypt text. Check if keyfiles are valid."),void(t.innerHTML="<i>Encryption failure</i>");t.textContent=e.cipher+e.iv}):n||showSnackbar("No keyfile selected. Select one above or generate a new one."):n||showSnackbar("Text to encrypt is blank")},i=$("startEnc");i.onclick=(()=>{const e=$("text-to-enc").MDCTextField.value.trim();n(e)}),$("startDec").onclick=(()=>{const e=$("cipher-text").MDCTextField.value.trim();0!==e.length?null!=t?window.aesCrypto.decrypt(e.slice(0,-24),e.slice(-24),t).then(e=>{const t=$("decrypted-output");if(null!=e.err)return showSnackbar("Failed to decrypt text. Check if keyfiles are valid and were also used to encrypt the text."),void(t.innerHTML="<i>Decryption failure</i>");t.textContent=e.text}):showSnackbar("No keyfile selected."):showSnackbar("Text to decrypt is blank")}),document.querySelectorAll(".output-area").forEach(e=>{e.onclick=(e=>{window.navigator.clipboard.writeText(e.target.textContent.trim()),showSnackbar("Copied text to clipboard")})});const c=$("inst-enc");let l="";c.onchange=(()=>{if(c.checked){i.disabled=!0;const e=$("text-to-enc").MDCTextField;n(e.value.trim(),!0),q("#text-to-enc textarea").oninput=(()=>{const t=$("text-to-enc").MDCTextField.value.trim();t!==l&&(n(e.value.trim(),!0),l=t)})}else i.disabled=!1,q("#text-to-enc textarea").oninput=null})}function onStop(){delete window.prevTimeOut}window.prevTimeOut=null;