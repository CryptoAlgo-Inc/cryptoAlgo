function $(e){return document.getElementById(e)}function q(e){return document.querySelector(e)}function showLoader(e=""){const n=$("loading-dialog").MDCDialog;n.scrimClickAction="",n.escapeKeyAction="",q("#loading-dialog .mdc-dialog__content .mdc-linear-progress").MDCLinearProgress.determinate=!1,q("#loading-dialog .mdc-dialog__content p").textContent=e,n.open()}function stopLoader(e=null){q("#loading-dialog .mdc-dialog__content .mdc-linear-progress").MDCLinearProgress.determinate=!0,$("loading-dialog").MDCDialog.close(e)}function togglePWD(e){const n=document.querySelector("#keyPWD>input");e.MDCCheckbox.checked?n.type="text":n.type="password"}function showSnackbar(e,n=5e3){const i=q(".mdc-snackbar").MDCSnackbar;i.labelText=e,i.timeoutMs=n,i.open()}function genAES(e=function(e){}){window.fileOps.filePick("Location to save AES keyfile","AES Keyfile Name:",[],[{name:"AES Keyfiles",extensions:[".aKey"]}]).then(n=>{n.canceled?showSnackbar("File picker canceled, AES keyfiles not generated. Please try again."):window.aesCrypto.keygen(n.filePath)?showSnackbar("An error was encountered while generating AES keyfiles. Please try again later."):(showSnackbar(`Successfully generated AES keyfile. Saved location: '${n.filePath}'`,1e4),e(n.filePath))})}function genRSA(e=function(e){}){const n=$("RSALen").MDCDialog;n.listen("MDCDialog:closed",function(n){if("continue"===n.detail.action){const n=parseInt($("RSAModLen").MDCTextField.value);if(!(4096<=n&&n<=10240))return showSnackbar("Keypair length is invalid. Please try generating RSA keypairs again."),void console.error(`<keygen> Invalid RSA modulus length: '${n.toString()}'`);window.fileOps.filePick("Location to save RSA keypair","RSA keypair base name:",[],[{name:"RSA Keypair",extensions:[".pem"]}]).then(i=>{i.canceled?showSnackbar("File picker canceled, RSA keypair not generated. Please try again."):(showLoader("Generating RSA keypair, please wait. This might take more than a minute depending on keypair length and your hardware."),window.rsaCrypto.keygen(n,$("keyPWD").MDCTextField.value,i.filePath,function(n){if(stopLoader("Finished generating keyfiles"),null!=n)return console.error("<keygen> RSA keypair generation failed with exit code",n),void showSnackbar("Failed to write RSA keypair to specified location, check if permissions are sufficient.");console.log("<keygen> Done generating one RSA keypair"),e(i.filePath)}))})}}),n.open()}async function onStart(){console.log("<keygen> Started keygen activity"),$("genAll").onclick=function(){let e,n;genAES(function(i){e=i,genRSA(function(e){n=e})})},$("genRSA").onclick=(()=>{genRSA()}),$("genAES").onclick=(()=>{genAES()})}function onStop(){console.log("<keygen> Detaching event listeners..."),$("genAll").onclick=null,console.log("<keygen> Exiting keygen activity")}