<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>CryptoAlgo</title>
        <link rel="stylesheet" href="assets/css/main.css" />
        <!-- The core Firebase JS SDK is always required and must be listed first -->
        <script src="https://www.gstatic.com/firebasejs/7.15.4/firebase-app.js"></script>

        <script src="assets/js/jquery.min.js" sync></script>

        <!-- TODO: Add SDKs for Firebase products that you want to use
                https://firebase.google.com/docs/web/setup#available-libraries -->
        <script src="https://www.gstatic.com/firebasejs/ui/4.5.1/firebase-ui-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.15.4/firebase-auth.js"></script>
        <script src="https://www.gstatic.com/firebasejs/7.15.4/firebase-storage.js"></script>

        <link type="text/css" rel="stylesheet" href="https://www.gstatic.com/firebasejs/ui/4.5.1/firebase-ui-auth.css" />
        <link type="text/css" rel="stylesheet" href="assets/css/authPage.css" />

        <script>
            // Your web app's Firebase configuration
            var firebaseConfig = {
                apiKey: "AIzaSyDu3GBqQg6o9Mp7Ay6KkTKRnqogZWmhU6c",
                authDomain: "cryptoalgogui.firebaseapp.com",
                databaseURL: "https://cryptoalgogui.firebaseio.com",
                projectId: "cryptoalgogui",
                storageBucket: "cryptoalgogui.appspot.com",
                messagingSenderId: "104602369567",
                appId: "1:104602369567:web:bcfdad88debbb2b8cddf2a",
                measurementId: "G-YT1W6G83B3"
            };
            // Initialize Firebase
            firebase.initializeApp(firebaseConfig);

            // Initialize the FirebaseUI Widget using Firebase.
            var ui = new firebaseui.auth.AuthUI(firebase.auth());

            // FirebaseUI config.
            var uiConfig = {
                signInSuccessUrl: ' ',
                signInOptions: [
                    // Leave the lines as is for the providers you want to offer your users.
                    firebase.auth.GoogleAuthProvider.PROVIDER_ID,
                    firebase.auth.GithubAuthProvider.PROVIDER_ID
                ],
                // tosUrl and privacyPolicyUrl accept either url string or a callback
                // function.
                // Terms of service url/callback.
                tosUrl: '<your-tos-url>',
                // Privacy policy url/callback.
                privacyPolicyUrl: function() {
                    window.location.assign('<your-privacy-policy-url>');
                }
            };
        </script>
        <script src="assets/js/authHelper.js" defer></script>
    </head>
    <body>
        <section id="one" class="wrapper style2 accountMgmt">
            <div style="text-align: center">
                <h2 id="headText"> </h2>

                <div id="profileSpace" style="display: none">
                    <!-- User elements (Profile pic, name and email) -->
                    <img id="usrProfilePic" onerror="this.src='images/pfpPlaceholder.png'" src="" alt="Profile Image" height="100px" width="100px"></img>
                    <h2 id="usrName" style="text-transform: none; font-weight: bold;">Hello, unknown user</h2>
                    <p id="usrEmail">Email</p>

                    <!-- The Modal -->
                    <div id="myModal" class="modal">

                        <!-- Modal content -->
                        <div class="modal-content">
                            <span class="close">&times;</span>
                            <p>Some text in the Modal..</p>
                        </div>

                    </div>

                    <!-- Email verification (Only becomes visible if needed) -->
                    <ul class="actions" id="verifyEmail" style="margin: 0 0 10px 0; display: none;">
                        <li><a onclick="verifyEmail()" title="Email Verification" class="button alt">Verify Email</a></li>
                    </ul>

                    <ul class="actions" style="margin: 10px 0 10px 0">
                        <li><a onclick="signOutUser()" title="Sign Out" class="button alt"><i class="material-icons">power_settings_new</i></a></li>
                        <li><a onclick="usrSettingsCloseOpen()" title="Profile Settings" class="button alt"><i class="material-icons" id="settingsBtn">settings</i></a></li>
                    </ul>

                    <!-- User Settings -->
                    <div id="profileSettings" class="auth" style="display: none;">
                        <h2 style="margin: 0px">Settings</h2>

                        <!-- Change name -->
                        <button class="collapsible"> Update Name </button>
                        <div class="content">
                            <label class="authLabels" for="displayName">New display name:</label>
                            <input class="authInput" type="text" id="displayName" name="displayName">

                            <ul class="actions" style="margin: 10px 0 10px 0">
                                <li><a onclick="updateProfile()" title="Save Settings" class="button alt"><i class="material-icons">done</i></a></li>
                            </ul>
                        </div>

                        <!-- Update Profile Picture -->
                        <button class="collapsible"> Update Profile Picture </button>
                        <div class="content">
                            <input accept="image/*" id="profilePicSelector" style="display: none" type="file">
                            <ul class="actions" style="margin: 10px 0 10px 0">
                                <li><a onclick="$('#profilePicSelector').click();" title="Upload picture" class="button alt"><i class="material-icons">upload</i></a></li>
                            </ul>
                        </div>

                        <!-- Change Password Portion -->
                        <button class="collapsible"> Change Password </button>
                        <div class="content" id="pwdChange">
                            <label class="authLabels" for="oldPwd">Old password: </label>
                            <input class="authInput" type="password" id="oldPwd" name="oldPwd">
                            <label class="authLabels" for="changePwd">New password: </label>
                            <input class="authInput" type="password" id="changePwd" name="changePwd">
                            <label class="authLabels" for="confirmChangePwd">Confirm password: </label>
                            <input class="authInput" type="password" id="confirmChangePwd" name="confirmChangePwd">

                            <ul class="actions" style="margin: 10px 0 10px 0">
                                <li><a onclick="changeUserPassword()" title="Save Settings" class="button alt"><i class="material-icons">done</i></a></li>
                            </ul>
                        </div>

                        <!-- Update Email Portion -->
                        <button class="collapsible"> Update Email </button>
                        <div class="content">
                            <label class="authLabels" for="emailChgPwd">Password: </label>
                            <input class="authInput" type="password" id="emailChgPwd" name="emailChgPwd">
                            <label class="authLabels" for="changeEmail">New email</label>
                            <input class="authInput" type="email" id="changeEmail" placeholder="New email address" name="changeEmail">

                            <ul class="actions" style="margin: 10px 0 10px 0">
                                <li><a onclick="updateEmail()" title="Save Settings" class="button alt"><i class="material-icons">done</i></a></li>
                            </ul>
                        </div>

                        <!-- Delete Account -->
                        <button class="collapsible">Account Deletion</button>
                        <div class="content">
                            <label class="authLabels" for="acctDeletePwd">Password: </label>
                            <input class="authInput" type="password" id="acctDeletePwd" name="acctDeletePwd">
                            <p style="color: red; margin: 10px 0 0 0">By clicking "Delete Account", I understand that my account will be permanently deleted. 
                            THIS ACTION CANNOT BE UNDONE! Any data stored in our database will be deleted and CANNOT be recovered.</p>
                            <ul class="actions" style="margin: 8px">
                                <li><a style="box-shadow: inset 0 0 0 2px red" onclick="deleteUser()" title="DELETE ACCOUNT" class="button alt">DELETE ACCOUNT</a></li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div id="loginArea" style="display: none">
                    <div class="auth" id="firebaseui-auth-container"></div>

                    <h3 style="margin-bottom: 5px; margin-top: 15px;">Email Sign-in</h3>

                    <div class="warningMsgBox auth" onclick="$('#warningBox1').fadeOut()" id="warningBox1">
                        <h2 id="warnings1" class="msgBox" style="text-transform: none;"></h2>
                    </div>

                    <div class="auth" id="emailLogin">
                        <div>
                            <label class="authLabels" for="username">Email:</label>
                            <input class="authInput" type="text" id="username" name="username">
                        </div>
                        <div>
                            <label class="authLabels" for="password">Password:</label>
                            <input class="authInput" type="password" id="password" name="password">
                        </div>
                        <a onclick="emailAuthLogin()" class="button alt submitBtn"><i class="material-icons">login</i></a>
                    </div>

                    <div id="newAccountHint">
                        <small> Or </small>
                        <a onclick="openAccountCreate()" class="button alt submitBtn">Create Account</a>
                    </div>

                    <div class="auth" id="newAccount" style="display: none;">
                        <div>
                            <label class="authLabels" for="newUsername">Email:</label>
                            <input class="authInput" type="text" id="newUsername" name="newUsername">
                        </div>
                        <div>
                            <label class="authLabels" for="newPassword">New Password:</label>
                            <input class="authInput" type="password" placeholder="7-64 characters starting with a letter" id="newPassword" name="NewPassword">
                        </div>
                        <div>
                            <label class="authLabels" for="confirmPassword">Confirm Password:</label>
                            <input class="authInput" type="password" id="confirmPassword" name="confirmPassword">
                        </div>
                        <a onclick="createNewAccount()" class="button alt submitBtn"><i class="material-icons">login</i></a>
                    </div>

                    <div id="backToLogin" style="display: none;">
                        <small> Or </small>
                        <a onclick="backToLogin()" class="button alt submitBtn">Login</a>
                    </div>

                </div>
            </div>
        </section>

            <!-- Footer -->
        <footer id="footer" class="wrapper">
            <div class="inner">
                <div class="copyright">
                    <p>This project is maintained by <a href="mailto:support@cryptoalgo.cf">@CryptoAlgo</a>.</p>
                </div>
            </div>
        </footer>

        <script>
            var coll = document.getElementsByClassName("collapsible");
            var i;

            for (i = 0; i < coll.length; i++) {
                coll[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var content = this.nextElementSibling;
                if (content.style.maxHeight){
                    content.style.maxHeight = null;
                } else {
                    content.style.maxHeight = content.scrollHeight + "px";
                } 
                });
            }
        </script>
    </body>
</html>